# 파일 입출력 <복습> 

파이썬에서 파일 다룰 때는 기본 내장함수 open() 함수를 활용합니다.


1. open() 함수
open() 함수의 사용법
첫번째 인수 file경로만이 필수입니다.  
mode : 파일이 열리는 모드   
* 'r' : 읽기 용으로 열림 (기본값)  
* 'w' : 쓰기 위해 열기, 파일을 먼저 자른다.  
* 'x' : 베타적 생성을 위해 열리고, 이미 존재하는 경우 실패  
* 'a' : 쓰기를 위해 열려 있고, 파일의 끝에 추가하는 경우 추가합니다.  
* 'b' : 2진 모드(바이너리 모드)  
* 't' : 텍스트 모드 (기본값)  
* '+' : 업데이트 (읽기 및 쓰기)를 위한 디스크 파일 열기  
파이썬에서 지원되는 인코딩 목록 -[https://docs.python.org/3.6/library/codecs.html](https://docs.python.org/3.6/library/codecs.html)  
파일 객체는 반드시 열고 작업이 완료되면 반드시 파일을 닫아야 합니다.  
파일을 닫지 않으면 버퍼링되어 있는 데이터는 기록되지 않고 소실될 수 있습니다.
file 객체의 close()메소드로 파일을 닫습니다.
2. 파일 쓰기  
파일을 작성하기 위해서는 새로운 파일을 open 해야합니다.  
mode='wt'라고 되어 있는 부분은 쓰기모드이면서 텍스트모드를 가리킵니다.  
```
f = open('test.txt', mode='wt', encoding='utf-8')
f.write('파이썬으로 파일을 작성하고 있습니다.') # 20
f.write('newline 문자로 개행해봅니다.\n') # 20
f.write('개행이 잘되었나요?') #10
f.close()  
```  
3. 파일 읽기  
mode는 mode='rt' 입니다.  
read(글자수)로 파일을 읽습니다.  
파일을 읽고 나서 내부 포인터는 읽은 마지막 끝으로 이동됩니다.  
```
r = open('test.txt', mode='rt', encoding='utf-8')
# 파일 내용 전체를 리턴받으려면 read메소드를 인수 없이 사용합니다.
r.read()
r.seek(0)
# readlines() 메소드는 파일의 라인별로 리스트 형태로 리턴합니다.
r.seek(0)
r.readlines()
# ['파이썬으로 파일을 작성하고 있습니다.newline 문자로 개행해봅니다.\n', '개행이 잘되었나요?']
 r.close() 
 ```
4. 파일 추가하기  
mode는 mode='at' 입니다.
```
a = open('test.txt', mode='at', encoding='utf-8')
a.writelines(['writelines로 추가합니다.', '내부 원소는 개행이 안되는군요.', '개행을 하려면 개행문자를 입력해야합니다.\n', '마지막에는 안붙여도 개행문자가..'])
a.close()
```

# 2차원 구조 엑셀 데이터 다루기  

엑셀은 전 세계에서 가장 사랑받는 데이터 관리/분석 프로그램입니다.  
스프레드 시트라는 눈에 보이는 화면이 있기 때문에 배우기에도 활용하기에도 매우 친절한 도구입니다.  
엑셀을 다루는 사람이 파이썬까지 사용할 수 있다면 아래의 장점을 가질 수 있습니다. 

* 파이썬의 장점
1. 다양한 데이터를 읽고 작업할 수 있습니다. xlsx, csv, sql 등  
2. 복잡한 처리 작업들을 비교적 손쉽게 할 수 있습니다. 반복 작업을 효율적으로 자동화할 수 있습니다.  
3. 대용량 데이터(GB 단위 이상)를 다룰 수 있습니다. 엑셀은 데이터 용량이 100MB을 넘어가거나, 데이터가 100만 행이 넘어가면 정상적으로 작동하지 않는 현상을 겪기도 합니다.   
4. 다른 사람의 작업을 똑같이 재현하고 검증할 수 있습니다.  
5. 손쉽게 데이터를 결합하고 분리할 수 있습니다. SQL처럼 데이터를 합치고 관계 연산을 수행할 수 있습니다.  

* 파이썬으로 엑셀 작업의 장점
1. 여러 개의 파일/시트로 구분되어 있는 데이터를 하나의 시트로 합칠 수 있습니다.    
2. 데이터를 특정 분류 기준에 따라 여러 개의 시트 또는 파일로 분리할 수 있습니다.  
3. 양식이 정해진 엑셀 파일에 값을 업데이트하여 원하는 수만큼 순식간에 만들 수 있습니다.  
   예시: 업체별 발주서 파일을 만든다. 
4. 매일 작성해야 하는 리포트를 자동으로 생성할 수 있습니다.  
5. 경쟁 업체의 상품 가격 모니터링을 자동화할 수 있습니다. 가격이 변경되면 내게 알려줍니다.  

## 1.파이썬을 엑셀처럼 사용하기: 데이터 열기 pandas read_excel()
파일 [https://drive.google.com/file/d/1rDeenjJEFB7S-d2wJDxAk08BNft406FM/view?usp=sharing](https://drive.google.com/file/d/1rDeenjJEFB7S-d2wJDxAk08BNft406FM/view?usp=sharing)
1. 데이터 열기  
엑셀의 경우 데이터를 열기 위해서는 해당 파일을 더블 클릭해서 열거나, 엑셀을 실행시킨 다음의 순서대로 파일을 열면 됩니다.  
파이썬의 경우에는 엑셀 파일(xlsx)을 열기 위해서는 판다스 라이브러리를 사용해야 합니다.  
판다스 라이브러리란 일종에 확장 프로그램으로 파이썬을 엑셀처럼 사용할 수 있게 도와주는 도구입니다.  
`import pandas as pd`
판다스 라이브러리를 불러와서 pd라는 축약어로 지정합니다. 매번 번거로우니 pd라는 짧은 단어 사용하기 위함입니다.  
* 판다스에서 엑셀 파일(xlsx)을 읽으려면 pd.read_excel()를 사용해야 합니다. 
```
sales = pd.read_excel('SupermarketSales.xlsx')
sales
```
SupermarketSales.xlsx라는 엑셀 파일을 읽어와 그 결과를 sales라는 이름의 변수에 저장했습니다. 이제 sales라는 변수를 입력하면 엑셀에서 보는 것과 유사하게 표 형식으로 읽어온 데이터를 화면에서 볼 수 있습니다.
* 엑셀과 판다스의 몇 가지 차이점  
 * 엑셀은 행 번호가 1부터 시작하지만 판다스는 0부터 시작합니다. 
 * 엑셀 파일에 값이 없는 데이터는 판다스에서 Nan(Null)로 표기됩니다.
* 판다스에서는 위와 같은 테이블 형식의 데이터
판다스는 데이터프레임이라는 자료구조로 저장합니다. 데이터프레임을 엑셀의 시트와 유사한 개념으로 생각하시면 됩니다.  
그리고 이 데이터프레임에서는 행 번호가 있는 부분을 Index라 합니다. 또한 각 열 데이터 이름을 Column name이라 합니다.

* sales 변수의 데이터 타입을 확인해보겠습니다.
```
type(sales)
```
데이터 정렬하기
판다스에서 데이터를 정렬하는 방법은 DataFrame.sort_values() 메서드를 사용하는 것입니다. 판다스로 데이터를 읽어오면 기본적으로 데이터프레임 형태기 때문에 읽어온 변수명 뒤에 .sort_values()라고 쓰면 됩니다.

import pandas as pd
sales = pd.read_excel('SupermarketSales.xlsx')
type(sales)
# >>> pandas.core.frame.DataFrame

### 코랩 코딩 실습: []()
